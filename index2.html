<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FFmpeg WASM Test</title>
  <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.12.4/dist/ffmpeg.min.js"></script>
</head>
<body>
  <h2>Test FFmpeg.wasm</h2>
  <button id="start">Start FFmpeg</button>
  <p id="output">Status: Idle</p>

  <script>
    // ✅ Define only after script is loaded
    let ffmpeg;

    document.getElementById('start').addEventListener('click', async () => {
      const output = document.getElementById('output');
      output.textContent = 'Initializing FFmpeg...';

      // ✅ Only now create ffmpeg instance
      const { createFFmpeg, fetchFile } = FFmpeg;
      ffmpeg = createFFmpeg({ log: true });

      try {
        await ffmpeg.load();
        output.textContent = 'FFmpeg loaded successfully!';
      } catch (err) {
        output.textContent = 'Failed to load FFmpeg: ' + err.message;
      }
    });
  </script>
</body>
</html>
