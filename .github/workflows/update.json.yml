name: Update Employee JSON

on:
  workflow_dispatch:
    inputs:
      name:
        description: 'Employee Name'
        required: true
      email:
        description: 'Employee Email'
        required: true
      role:
        description: 'Employee Role'
        required: true
      department:
        description: 'Employee Department'
        required: true

jobs:
  update_json:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Update Employee JSON
        run: |
          EMPLOYEE_FILE="employees.json"
          if [ -f $EMPLOYEE_FILE ]; then
            cat $EMPLOYEE_FILE | jq ".employees += [{\"name\":\"${{ github.event.inputs.name }}\", \"email\":\"${{ github.event.inputs.email }}\", \"role\":\"${{ github.event.inputs.role }}\", \"department\":\"${{ github.event.inputs.department }}\"}]" > temp.json && mv temp.json $EMPLOYEE_FILE
          else
            echo "{\"employees\": [{\"name\":\"${{ github.event.inputs.name }}\", \"email\":\"${{ github.event.inputs.email }}\", \"role\":\"${{ github.event.inputs.role }}\", \"department\":\"${{ github.event.inputs.department }}\"}]}" > $EMPLOYEE_FILE
          fi
          git config --global user.email "your-email@example.com"
          git config --global user.name "Your Name"
          git commit -am "Add new employee"
          git push
